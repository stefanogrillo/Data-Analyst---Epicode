# 3.4 Progetto su Pandas, Cursor e MySQL 

[Parte 1](https://github.com/stefanogrillo/Data-Analyst---Epicode/blob/4b215e63e39b1ce6ac089a1273e9c5af09a4218b/Week%203/3.4%20Progetto/3.4%20Progetto%20pt%201%20-%20Cursori.ipynb)

[Parte 1 in codice](https://github.com/stefanogrillo/Data-Analyst---Epicode/blob/4b215e63e39b1ce6ac089a1273e9c5af09a4218b/Week%203/3.4%20Progetto/3.4%20Progetto%20pt%201%20-%20Cursory.py)

[Parte 2](https://github.com/stefanogrillo/Data-Analyst---Epicode/blob/4b215e63e39b1ce6ac089a1273e9c5af09a4218b/Week%203/3.4%20Progetto/3.4%20Progetto%20pt%202%20-%20Pandas.ipynb)

[Parte 2 in codice](https://github.com/stefanogrillo/Data-Analyst---Epicode/blob/4b215e63e39b1ce6ac089a1273e9c5af09a4218b/Week%203/3.4%20Progetto/3.4%20Progetto%20pt%202%20-%20Pandas.py)

In questo progetto analizziamo un database di un ecommerce, sia tramite cursore che tramite Pandas. Il database scelto è su MySQL: per utilizzarlo va installato sul computer il software MySQL e da lì va importato il DB.

### LIBRARIES

```python
# import mysql.connector
from sqlalchemy import create_engine
import pprint
import numpy as np
import pandas as pd
from matplotlib import pyplot as plt
# from pandas_profiling import ProfileReport
from methods import lista
```
Notare che dal documento methods si importa una lista, che contiene le queries che vogliamo iterare.
### METHODS

```python
# METHODS for CURSOR
def connection_database(user, password, host, database):
    """
    Create a connection with the SQL DataBase
    :variable: user: user's name
    :variable: password: user's password
    :variable: host: IP address of the SQL server
    :variable: database: SQL DB's name
    :return: conn (connection) or None
    """
    try:
        c = mysql.connector.connect(user=user, password=password, host=host, database=database)
        return c
    except mysql.connector.errors.DatabaseError as db_error:
        print(db_error.msg)
        return None


def close_connection(connection):
    """
    Close a connection to the SQL DataBase
    :variable: user: user's name
    """
    connection.close()


def trying(sqll):
    """
    Take a SQL statement and try/except it, visualizing the outcome
    :variable: sql: SQL statement
    """
    try:
        cursor.execute(sqll)
        result = cursor.fetchall()
        return result
    except:
        conn.rollback()
```

### ANALISI - CURSORI

```python
# CONNECTOR
if __name__ == "__main__":
    # conn = mysql.connector.connect(user="", password="", host="127.0.0.1", database="ecommerce")
    conn = connection_database(user="", password="", host="127.0.0.1", database="ecommerce")
    
        try:
        cursor = conn.cursor()

        # versione breve, iterando le query da un doc esterno "methods"
        if True:
            print(len(lista))
            # Printa le queries una alla volta
            for i in range(0, len(lista)):
                if i == 0:
                    print("\n1 QUALI TABELLE SONO NEL DATABASE ecommerce?")
                elif i == 1:
                    print("\n2a QUANTE MARCHE SONO VENDUTE NEL ecommerce?")
                elif i == 2:
                    print("\n2b QUALI MARCHE SONO VENDUTE NEL ecommerce?")
                elif i == 3:
                    print("\n3a QUANTI PRODOTTI SONO IN LISTA?")
                elif i == 4:
                    print("\n3b QUANTI PRODOTTI SONO IN MAGAZZINO?")
                elif i == 5:
                    print("\n3c QUALI SONO I PRIMI 5 PRODOTTI?")
                elif i == 6:
                    print("\n3d QUALI PRODOTTI SONO CORRELATI?")
                elif i == 7:
                    print("\n4a QUANTE SONO LE CATEGORIE?")
                elif i == 8:
                    print("\n4b QUALI SONO LE ULTIME 10?")
                elif i == 9:
                    print("\n4c QUALI CELLULARI SONO IN MAGAZZINO?")
                elif i == 10:
                    print("\n4d QUALI SOFTWARE WINDOWS SONO IN MAGAZZINO?")
                elif i == 11:
                    print("\n5a A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?")
                elif i == 12:
                    print("\n5b VALORE E PREZZO SONO LA STESSA COSA? ESEMPIO PER id prodotto: '4000001'")
                elif i == 13:
                    print("\n6 QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?")
                elif i == 14:
                    print("\n7a QUANTI PRODOTTI CI SONO PER CATEGORIA?")
                elif i == 15:
                    print("\n7b QUANTI PRODOTTI CI SONO PER MARCA?")
                elif i == 16:
                    print("\n8a QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA'?")
                elif i == 17:
                    print("\n8b QUALI SONO I 5 PRODOTTI BESTSELLER PER GUADAGNO?")
                elif i == 18:
                    print("\n9 QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?")
                elif i == 19:
                    print("\n10a A QUALI CITTA SI SPEDISCE DI PIU'?")
                else:
                    print("\n10b A QUALI PROVINCE SI SPEDISCE DI PIU'?")
                pprint.pprint(trying(lista[i]))

        # versione lunga
        if False:
            # QUERY 1: QUALI TABELLE SONO NEL DATABASE ecommerce?
            sql1 = "SHOW TABLES;"
            print("\n1 QUALI TABELLE SONO NEL DATABASE ecommerce?")
            pprint.pprint(trying(sql1))


            # QUERY 2: QUANTE E QUALI MARCHE SONO VENDUTE NEL ecommerce?
            sql2a = "SELECT count(nome) numero FROM marca;"
            sql2b = "SELECT nome FROM marca ORDER BY nome DESC LIMIT 10;"
            print("\n2a QUANTE MARCHE SONO VENDUTE NEL ecommerce?")
            pprint.pprint(trying(sql2a))
            print("\n2b QUALI MARCHE SONO VENDUTE NEL ecommerce?")
            pprint.pprint(trying(sql2b))


            # QUERY 3: QUANTI E QUALI PRODOTTI SONO IN MAGAZZINO?
            sql3a = "SELECT count(nome) numero_prodotti FROM prodotto;"
            sql3b = "SELECT count(nome) numero_prodotti FROM prodotto WHERE quantita > 0;"
            sql3c = "SELECT nome FROM prodotto ORDER BY nome ASC LIMIT 5;"
            sql3d = "SELECT p.pid, p.nome, pp.nome, pp.pid FROM prodotto p JOIN correlati c ON p.pid = c.pid JOIN prodotto pp ON " \
                    "c.relpid = pp.pid;"
            print("\n3a QUANTI PRODOTTI SONO IN LISTA?")
            print(trying(sql3a))
            print("\n3b QUANTI PRODOTTI SONO IN MAGAZZINO?")
            print(trying(sql3b))
            print("\n3c QUALI SONO I PRIMI 5 PRODOTTI?")
            pprint.pprint(trying(sql3c))
            print("\n3d QUALI PRODOTTI SONO CORRELATI?")
            pprint.pprint(trying(sql3d))


            # QUERY 4: A CHE CATEGORIE CORRISPONDONO I PRODOTTI IN MAGAZZINO?
            sql4a = "SELECT count(nome) as numero_categorie FROM categoria;"
            sql4b = "SELECT nome FROM categoria ORDER BY nome DESC LIMIT 10;"
            # e quali cellulari e software hanno nel ecommerce?
            sql4c = "SELECT p.pid, p.nome, p.quantita FROM prodotto p JOIN categoria c ON c.cid=p.cid WHERE c.nome LIKE 'CELL%';"
            sql4d = "SELECT p.pid, p.nome, p.quantita FROM prodotto p JOIN categoria c ON c.cid=p.cid WHERE p.nome LIKE 'windows%';"
            print("\n4a QUANTE SONO LE CATEGORIE?")
            pprint.pprint(trying(sql4a))
            print("\n4b QUALI SONO LE ULTIME 10?")
            pprint.pprint(trying(sql4b))
            print("\n4c QUALI CELLULARI SONO IN MAGAZZINO?")
            pprint.pprint(trying(sql4c))
            print("Sono in lista, ma non sono in magazzino")
            print("\n4d QUALI SOFTWARE WINDOWS SONO IN MAGAZZINO?")
            pprint.pprint(trying(sql4d))
            print("Sono in lista, ma non sono in magazzino")


            # QUERY 5: A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?
            sql5a = "SELECT p.pid, p.nome, pr.valore FROM prodotto p JOIN categoria c ON c.cid=p.cid JOIN prezzo pr ON " \
                    "p.pid = pr.pid WHERE p.nome LIKE 'windows%';"
            # valore e prezzo sono la stessa cosa? (ex: prezzo e valore per pid = "4000001")
            sql5b = "SELECT p.pid, p.nome, o.prezzo, pr.valore FROM prodotto p LEFT JOIN orpr01 o ON o.pid=p.pid LEFT " \
                    "JOIN prezzo pr ON p.pid = pr.pid WHERE p.pid = '4000001';"
            print("\n5a A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?")
            pprint.pprint(trying(sql5a))
            print("Qui è rappresentato il valore")
            print("\n5b VALORE E PREZZO SONO LA STESSA COSA? ESEMPIO PER id prodotto: '4000001'")
            pprint.pprint(trying(sql5b))
            print("Valore e prezzo non sono la stessa cosa")


            # QUERY 6: QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?
            sql6a = "SELECT c.nome, AVG(pr.valore) media FROM categoria c JOIN prodotto p ON c.cid=p.cid JOIN prezzo pr ON pr.pid=p.pid GROUP BY c.nome ORDER BY media DESC;"
            print("\n6 QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?")
            pprint.pprint(trying(sql6a))


            # QUERY 7: QUANTI PRODOTTI CI SONO PER CATEGORIA? E PER MARCA?
            sql7a = "SELECT c.nome, count(c.nome) numero FROM categoria c JOIN prodotto p ON c.cid=p.cid GROUP BY c.nome ORDER BY numero DESC;"
            sql7b = "SELECT m.nome, count(m.nome) numero FROM marca m JOIN prodotto p ON p.mid = m.mid GROUP BY m.nome ORDER BY numero DESC;"
            print("\n7a QUANTI PRODOTTI CI SONO PER CATEGORIA?")
            pprint.pprint(trying(sql7a))
            print("\n7b QUANTI PRODOTTI CI SONO PER MARCA?")
            pprint.pprint(trying(sql7b))


            # QUERY 8: QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA' E GUADAGNO?
            sql8a = "SELECT p.pid, od.oid, p.nome, p.quantita as qta_stock, sum(o.quantita) as quantita_venduta_tot, prezzo*sum(o.quantita) as prezzo_tot, prezzo FROM prodotto p JOIN orpr01 o ON p.pid = o.pid JOIN ordine od ON od.oid = o.oid GROUP BY o.pid ORDER BY quantita_venduta_tot DESC LIMIT 6;"
            sql8b = "SELECT p.pid, od.oid, p.nome, p.quantita as qta_stock, sum(o.quantita) as quantita_venduta_tot, prezzo*sum(o.quantita) as prezzo_tot, prezzo FROM prodotto p JOIN orpr01 o ON p.pid = o.pid JOIN ordine od ON od.oid = o.oid GROUP BY o.pid ORDER BY prezzo_tot DESC LIMIT 5;"
            print("\n8a QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA'?")
            pprint.pprint(trying(sql8a))
            print("1: DIMM DDRII\n2: SCHEDA MADRE ASROCK\n3: MODULA PLUG\n4: CARTUCCIA CANON\n5: CARICABATTERIE UNIVERSALE")
            print("\n8b QUALI SONO I 5 PRODOTTI BESTSELLER PER GUADAGNO?")
            pprint.pprint(trying(sql8b))
            print("1: ACER AS5810T-354G32MN\n2: MONITOR LCD LG\n3: SCHEDA MADRE ASROCK\n4: SCHEDA MADRE AM3\n5: TONER HP")


            # QUERY 9: QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?
            sql9a = "SELECT count(oid) as numero_ordini, s.nome as metodo_spedizione, s.costo, count(oid)*s.costo as costo_spedizioni_tot, pag.nome as metodo_pagamento, pag.costo, count(oid)*pag.costo as costo_pagamento_tot FROM pasp01 pa JOIN spedizione s ON pa.spid = s.spid RIGHT JOIN ordine o ON o.paspid = pa.paspid JOIN pagamento pag ON pa.paid = pag.paid GROUP BY s.nome, pag.nome;"
            print("\n9 QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?")
            print(trying(sql9a))
            print("Metodo spedizione: Consegna con corriere GLS = 14; Spedizione in posta = 11;\nMetodo di pagamento: Contrassegno = 15; Pagamento con Carta di Credito = 10;")


            # QUERY 10: A QUALI CITTA E PROVINCE SI SPEDISCE DI PIU'?
            sql10a = "SELECT provincia, citta, count(citta) as numero_indirizzi_utente FROM indirizzo GROUP BY provincia, citta ORDER BY provincia, numero_indirizzi_utente DESC;"
            sql10b = "SELECT provincia, count(citta) as numero_indirizzi_utente FROM indirizzo GROUP BY provincia ORDER BY numero_indirizzi_utente DESC;"
            print("\n10a A QUALI CITTA SI SPEDISCE DI PIU'?")
            pprint.pprint(trying(sql10a))
            print("Città: Roma, Milano")
            print("\n10b A QUALI PROVINCE SI SPEDISCE DI PIU'?")
            pprint.pprint(trying(sql10b))
            print("Province: Roma, Milano")

    except:
        conn.rollback()
    finally:
        if conn is not None:
            close_connection(conn)
```

### ANALISI - PANDAS

### METODI

```python
def get_databases_table():
    """
    Prints the databases' tables' names
    :return: prints the table's names
    """
    inspector = inspect(db_connection)
    i = 0
    for table_name in inspector.get_table_names():
        print("Table %s: %s" % (i, table_name))
        i += 1


def choose_table(name):
    """
    In this method, we select data from either a table or a SQL statement
    :variable: name: either a table or a SQL statement
    :return: tavola: the data needed
    """
    tavola = pd.read_sql(name, db_connection)
    return tavola


def choose_tables_n_merge(name1, name2):
    """
    Given two tables, this method creates a new one with merged values
    :variable: name1: either a table or a SQL statement
    :variable: name2: either a table or a SQL statement
    :return: tavola3: the merged data
    """
    tavola1 = pd.read_sql(name1, db_connection)
    tavola2 = pd.read_sql(name2, db_connection)

    tavola3 = tavola1.merge(tavola2)
    return tavola3
```
Anche per Pandas è stata creata la possibilità di iterare le queries in un for loop. La scelta di farlo sta al user, visto che alcune query della versione "lenta" sono state ricostruite con operazioni tipo merge, drop columns, special prints (per fare esempi) tramite Pandas, e non semplicemente iterando le queries in Pandas. 
```python

# PANDAS
db_connection_str = 'mysql+mysqlconnector://root:rootstefano17@127.0.0.1/ecommerce'
db_connection = create_engine(db_connection_str)


# versione breve
if True:
    # Crea una lista di queries:
    print(len(lista))
    # Printa le queri una alla volta
    for i in range(0, len(lista)):
        if i == 0:
            print("\n1 QUALI TABELLE SONO NEL DATABASE ecommerce?")
        elif i == 1:
            print("\n2a QUANTE MARCHE SONO VENDUTE NEL ecommerce?")
        elif i == 2:
            print("\n2b QUALI MARCHE SONO VENDUTE NEL ecommerce?")
        elif i == 3:
            print("\n3a QUANTI PRODOTTI SONO IN LISTA?")
        elif i == 4:
            print("\n3b QUANTI PRODOTTI SONO IN MAGAZZINO?")
        elif i == 5:
            print("\n3c QUALI SONO I PRIMI 5 PRODOTTI?")
        elif i == 6:
            print("\n3d QUALI PRODOTTI SONO CORRELATI?")
        elif i == 7:
            print("\n4a QUANTE SONO LE CATEGORIE?")
        elif i == 8:
            print("\n4b QUALI SONO LE ULTIME 10?")
        elif i == 9:
            print("\n4c QUALI CELLULARI SONO IN MAGAZZINO?")
        elif i == 10:
            print("\n4d QUALI SOFTWARE WINDOWS SONO IN MAGAZZINO?")
        elif i == 11:
            print("\n5a A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?")
        elif i == 12:
            print("\n5b VALORE E PREZZO SONO LA STESSA COSA? ESEMPIO PER id prodotto: '4000001'")
        elif i == 13:
            print("\n6 QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?")
        elif i == 14:
            print("\n7a QUANTI PRODOTTI CI SONO PER CATEGORIA?")
        elif i == 15:
            print("\n7b QUANTI PRODOTTI CI SONO PER MARCA?")
        elif i == 16:
            print("\n8a QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA'?")
        elif i == 17:
            print("\n8b QUALI SONO I 5 PRODOTTI BESTSELLER PER GUADAGNO?")
        elif i == 18:
            print("\n9 QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?")
        elif i == 19:
            print("\n10a A QUALI CITTA SI SPEDISCE DI PIU'?")
        else:
            print("\n10b A QUALI PROVINCE SI SPEDISCE DI PIU'?")
        print(choose_table(lista[i]))


# versione lunga
# QUERY 1: QUALI TABELLE SONO NEL DATABASE ecommerce?
if True:
    sql1 = "SHOW TABLES;"
    print("\n1 QUALI TABELLE SONO NEL DATABASE ecommerce?\n", choose_table(sql1))
# QUERY 1: ma con pandas
# (True/True switch to speed up the program)
if True:
    get_databases_table()


# QUERY 2: QUANTE E QUALI MARCHE SONO VENDUTE NEL ecommerce?
if True:
    sql2a = "SELECT count(nome) numero FROM marca;"
    sql2b = "SELECT nome FROM marca ORDER BY nome DESC LIMIT 10;"
    print("\n2a QUANTE MARCHE SONO VENDUTE NEL ecommerce?\n", choose_table(sql2a))
    print("\n2b QUALI MARCHE SONO VENDUTE NEL ecommerce?\n", choose_table(sql2b))
# QUERY 2: ma con pandas
# (True/True switch to speed up the program)
if True:
    pdsql2 = choose_table("marca")
    count = len(pdsql2['nome'])
    print("\n2a QUANTE MARCHE SONO VENDUTE NEL ecommerce?\n", count)
    print("\n2b QUALI MARCHE SONO VENDUTE NEL ecommerce?\n", pdsql2['nome'])


# QUERY 3: QUANTI E QUALI PRODOTTI SONO IN MAGAZZINO?
if True:
    sql3a = "SELECT count(nome) numero_prodotti FROM prodotto;"
    sql3b = "SELECT count(nome) numero_prodotti FROM prodotto WHERE quantita > 0;"
    sql3c = "SELECT nome FROM prodotto ORDER BY nome ASC LIMIT 5;"
    sql3d = "SELECT p.pid, p.nome, pp.nome, pp.pid FROM prodotto p JOIN correlati c ON p.pid = c.pid JOIN prodotto pp ON " \
            "c.relpid = pp.pid;"
    print("\n3a QUANTI PRODOTTI SONO IN LISTA?\n", choose_table(sql3a))
    print("\n3b QUANTI PRODOTTI SONO IN MAGAZZINO?\n", choose_table(sql3b))
    print("\n3c QUALI SONO I PRIMI 5 PRODOTTI?\n", choose_table(sql3c))
    print("\n3d QUALI PRODOTTI SONO CORRELATI?\n", choose_table(sql3d))
# QUERY 3: ma con pandas
# (True/True switch to speed up the program)
if True:
    pdsql3 = choose_table("prodotto")
    print("\n3a QUANTI PRODOTTI SONO IN LISTA?\n", len(pdsql3['nome']))

    pdsql32 = pdsql3[pdsql3.quantita > 0]
    print("\n3b QUANTI PRODOTTI SONO IN MAGAZZINO\n", len(pdsql32['nome']))

    print("\n3c QUALI SONO I PRIMI 5 PRODOTTI?\n", pdsql3['nome'].sort_values().head(5))

    # Terza query: pre-lavorazioni
    dsql3ab = choose_tables_n_merge("prodotto", "correlati")

    dsql3ab = dsql3ab[['pid', 'nome', 'relpid']]
    dsql3a = choose_table("prodotto")
    dsql3a = dsql3a[['pid', 'nome']]

    dsql3aba = pd.merge(dsql3ab.set_index('relpid'), dsql3a, right_on='pid', left_index=True)
    dsql3aba.drop('pid', axis=1, inplace=True)
    # special print
    with pd.option_context('display.max_rows', None,
                           'display.max_columns', None,
                           'display.precision', 3,
                           ):
        print("\n3d QUALI PRODOTTI SONO CORRELATI?\n", dsql3aba)


# QUERY 4: A CHE CATEGORIE CORRISPONDONO I PRODOTTI IN MAGAZZINO?
if True:
    sql4a = "SELECT count(nome) as numero_categorie FROM categoria;"
    sql4b = "SELECT nome FROM categoria ORDER BY nome DESC LIMIT 10;"
    # e quali cellulari e software hanno nel ecommerce?
    sql4c = "SELECT p.pid, p.nome, p.quantita FROM prodotto p JOIN categoria c ON c.cid=p.cid WHERE c.nome LIKE 'CELL%';"
    sql4d = "SELECT p.pid, p.nome, p.quantita FROM prodotto p JOIN categoria c ON c.cid=p.cid WHERE p.nome LIKE 'windows%';"
    print("\n4a QUANTE SONO LE CATEGORIE?\n", choose_table(sql4a))
    print("\n4b QUALI SONO LE ULTIME 10?\n", choose_table(sql4b))
    print("\n4c QUALI CELLULARI SONO IN MAGAZZINO?\n", choose_table(sql4c))
    print("Sono in lista, ma non sono in magazzino")
    print("\n4d QUALI SOFTWARE WINDOWS SONO IN MAGAZZINO?\n", choose_table(sql4d))
    print("Sono in lista, ma non sono in magazzino")
# QUERY 4: ma con pandas
# (True/True switch to speed up the program)
if True:
    cat = choose_table("categoria")
    num_nomi = len(cat[['nome']])
    print("\n4a QUANTE SONO LE CATEGORIE?\n", num_nomi)

    # "ascending = falso" mette in discendente
    cat2 = cat.sort_values(['nome'], ascending=[True])
    print("\n4b QUALI SONO LE ULTIME 10?\n", cat2['nome'].head(10))

    dsql4a = choose_table("prodotto")
    dsql4b = choose_table("categoria")
    dsql4ab = pd.merge(dsql4a.set_index('cid'), dsql4b, how='right',right_on='cid', left_index=True)
    dsql4ab = dsql4ab[['pid', 'nome_x', 'quantita', 'nome_y']]
    dsql4abc = dsql4ab

    dsql4ab = dsql4ab[dsql4ab['nome_y'].str.contains('CELL')]
    with pd.option_context('display.max_rows', None,
                           'display.max_columns', None,
                           'display.precision', 3,
                           ):
        print("\n4c QUALI CELLULARI SONO IN MAGAZZINO?\n", dsql4ab)

    dsql4abc = dsql4abc[dsql4abc['nome_y'].str.contains('MICROSOFT')]
    with pd.option_context('display.max_rows', None,
                           'display.max_columns', None,
                           'display.precision', 3,
                           ):
        print("\n4d QUALI SOFTWARE WINDOWS SONO IN MAGAZZINO?\n", dsql4abc)


# QUERY 5: A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?
if True:
    sql5a = "SELECT p.pid, p.nome, pr.valore FROM prodotto p JOIN categoria c ON c.cid=p.cid JOIN prezzo pr ON " \
            "p.pid = pr.pid WHERE p.nome LIKE 'windows%';"
    # valore e prezzo sono la stessa cosa? (ex: prezzo e valore per pid = "4000001")
    sql5b = "SELECT p.pid, p.nome, o.prezzo, pr.valore FROM prodotto p LEFT JOIN orpr01 o ON o.pid=p.pid LEFT " \
            "JOIN prezzo pr ON p.pid = pr.pid WHERE p.pid = '4000001';"
    print("\n5a A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?\n", choose_table(sql5a))
    print("Qui è rappresentato il valore")
    print("\n5b VALORE E PREZZO SONO LA STESSA COSA? ESEMPIO PER id prodotto: '4000001'\n", choose_table(sql5b))
    print("Valore e prezzo non sono la stessa cosa")


# QUERY 6: QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?
if True:
    sql6a = "SELECT c.nome, AVG(pr.valore) media FROM categoria c JOIN prodotto p ON c.cid=p.cid JOIN prezzo pr ON pr.pid=p.pid GROUP BY c.nome ORDER BY media DESC;"
    print("\n6 QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?\n", choose_table(sql6a))


# QUERY 7: QUANTI PRODOTTI CI SONO PER CATEGORIA? E PER MARCA? + PLOT
if True:
    sql7a = "SELECT c.nome, count(c.nome) numero FROM categoria c JOIN prodotto p ON c.cid=p.cid GROUP BY c.nome ORDER BY numero DESC;"
    sql7b = "SELECT m.nome, count(m.nome) numero FROM marca m JOIN prodotto p ON p.mid = m.mid GROUP BY m.nome ORDER BY numero DESC;"
    print("\n7a QUANTI PRODOTTI CI SONO PER CATEGORIA?\n", choose_table(sql7a))
    print("\n7b QUANTI PRODOTTI CI SONO PER MARCA?\n", choose_table(sql7b))

    # BARPLOT 1: PRODOTTI PER CATEGORIA
    df7a = pd.DataFrame(choose_table(sql7a))

    # REPORT
    # profile = ProfileReport(df7a, title="Pandas Profiling Report")
    # profile.to_file("report1.html")

    ls7a = df7a.values.tolist()
    ls7ax = []
    la7ay = []
    for i in range(0, len(ls7a)):
        ls7ax.append(ls7a[i][0])
        la7ay.append(ls7a[i][1])

    # barh per horizontal
    plt.bar(ls7ax, la7ay)
    plt.show()

    # BARPLOT 2: PRODOTTI PER MARCA
    df7b = pd.DataFrame(choose_table(sql7b))

    # REPORT
    # profile = ProfileReport(df7a, title="Pandas Profiling Report")
    # profile.to_file("report1.html")

    ls7b = df7b.values.tolist()
    ls7bx = []
    la7by = []
    for i in range(0, len(ls7b)):
        ls7bx.append(ls7b[i][0])
        la7by.append(ls7b[i][1])

    plt.bar(ls7bx, la7by)
    plt.show()


# QUERY 8: QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA' E GUADAGNO?
if True:
    sql8a = "SELECT p.pid, od.oid, p.nome, p.quantita as qta_stock, sum(o.quantita) as quantita_venduta_tot, prezzo*sum(o.quantita) as prezzo_tot, prezzo FROM prodotto p JOIN orpr01 o ON p.pid = o.pid JOIN ordine od ON od.oid = o.oid GROUP BY o.pid ORDER BY quantita_venduta_tot DESC LIMIT 6;"
    sql8b = "SELECT p.pid, od.oid, p.nome, p.quantita as qta_stock, sum(o.quantita) as quantita_venduta_tot, prezzo*sum(o.quantita) as prezzo_tot, prezzo FROM prodotto p JOIN orpr01 o ON p.pid = o.pid JOIN ordine od ON od.oid = o.oid GROUP BY o.pid ORDER BY prezzo_tot DESC LIMIT 5;"
    # special print
    with pd.option_context('display.max_rows', None,
                           'display.max_columns', None,
                           'display.precision', 3,
                           ):
        print("\n8a QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA'?\n", choose_table(sql8a))
        print("\n8b QUALI SONO I 5 PRODOTTI BESTSELLER PER GUADAGNO?\n", choose_table(sql8b))


# QUERY 9: QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?
if True:
    sql9a = "SELECT count(oid) as numero_ordini, s.nome as metodo_spedizione, s.costo, count(oid)*s.costo as costo_spedizioni_tot, pag.nome as metodo_pagamento, pag.costo, count(oid)*pag.costo as costo_pagamento_tot FROM pasp01 pa JOIN spedizione s ON pa.spid = s.spid RIGHT JOIN ordine o ON o.paspid = pa.paspid JOIN pagamento pag ON pa.paid = pag.paid GROUP BY s.nome, pag.nome;"
    # special print
    with pd.option_context('display.max_rows', None,
                           'display.max_columns', None,
                           'display.precision', 3,
                           ):
        print("\n9 QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?\n", choose_table(sql9a))


# QUERY 10: A QUALI CITTA E PROVINCE SI SPEDISCE DI PIU'?
if True:
    sql10a = "SELECT provincia, citta, count(citta) as numero_indirizzi_utente FROM indirizzo GROUP BY provincia, citta ORDER BY provincia, numero_indirizzi_utente DESC;"
    sql10b = "SELECT provincia, count(citta) as numero_indirizzi_utente FROM indirizzo GROUP BY provincia ORDER BY numero_indirizzi_utente DESC;"
    print("\n10a A QUALI CITTA SI SPEDISCE DI PIU'?\n", choose_table(sql10a))
    print("Città: Roma, Milano")
    print("\n10b A QUALI PROVINCE SI SPEDISCE DI PIU'\n?", choose_table(sql10b))
    print("Province: Roma, Milano")
```

```
C:\Users\elste\Desktop\epicode\Scripts\python.exe "C:\Users\elste\Desktop\epicode\3_Week\Day 4\3.4 Progetto pt 1 - Cursori.py" 

1 QUALI TABELLE SONO NEL DATABASE ecommerce?
[('categoria',),
 ('correlati',),
 ('immagine',),
 ('indirizzo',),
 ('listino',),
 ('livello',),
 ('marca',),
 ('ordine',),
 ('orpr01',),
 ('pagamento',),
 ('pasp01',),
 ('prezzo',),
 ('prim01',),
 ('prodotto',),
 ('spedizione',),
 ('stato',),
 ('subcat',),
 ('utente',)]

2a QUANTE MARCHE SONO VENDUTE NEL ecommerce?
[(89,)]

2b QUALI MARCHE SONO VENDUTE NEL ecommerce?
[('XFX',),
 ('WESTERN DIGI-TAL',),
 ('WACOM',),
 ('VERBATIM',),
 ('V-DA-TA',),
 ('TWINTECH',),
 ('TRAXDATA',),
 ('TRASCEND',),
 ('TP-LINK',),
 ('TOSHIBA',)]

3a QUANTI PRODOTTI SONO IN LISTA?
[(747,)]

3b QUANTI PRODOTTI SONO IN MAGAZZINO?
[(184,)]

3c QUALI SONO I PRIMI 5 PRODOTTI?
[('ACCESS POINT TP-LINK 108MBPS AH300350T SUPPORTA IEEE802.11G, IEEEE802.11B, '
  'EEE802.3, IEEE802.3U',),
 ('ACCESS POINT TP-LINK TL-WA500G, 54MBPS, SUPPORTS WDS, SUPPORTS AP-AP ',),
 ('ACCESS POINT TP-LINK TL-WA901ND, 300MBPS, POTENZA 20DBM (MAX), REPEATER, '
  'BRIDGE',),
 ('ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',),
 ('ACER ASPIRE 5736Z-453G32MNKK (LX.R7Z02.003), DUAL CORE T4500, 3GB DI RAM, '
  '320GB SATA, WIRELESS, DVD ',)]

3d QUALI PRODOTTI SONO CORRELATI?
[('4000007',
  'DIMM NILOX MN1004 1GB DDR 400MHZ PC-3200',
  'RAM DDR 400 PC3200 CORSAIR 1GB VS1GB400C3',
  '4000006'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'BATTERIA TAMPONE AL LITIO 3 VOLT A BOTTONE IEC TYP CR2032, DL2032, 5004LX, '
  'E-CR2032',
  'ACC0013'),
 ('ACC0032',
  'CUFFIE SHIN-TEK FHS16215 JOCKEY BLACK',
  'ADATTATORE HOST IDE-SATA INTER-NO',
  'ACC0033'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'ALIMENTATORE 500W AMD-INTEL 20-24 PIN VENTOLA SILENT',
  'ALI0001'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'ALIMENTATORE INTER-TECH SL-700 700W SILENT',
  'ALI0012'),
 ('ZNS0001',
  'CAVO RETE UTP CAT.5E NON SCHERMATO - LUNGHEZZA MT2',
  'ALIMENTATORE INTER-TECH SL-700 700W SILENT',
  'ALI0012'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'CASE MID 500W ITEK SPA-CE',
  'CAS0016'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'CARTUCCIA HP 88 (C9388AE) GIALLO PER STAMPANTI K550XI DTN, PRO K5300, PRO '
  'K5400, PRO K5400DN, PRO ',
  'CIN0024'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'HARD DISK ESTERNO 3,5pollici; WESTERN DIGITAL 1TB WDBAAU0010HBK',
  'HDE0003'),
 ('NOT0001',
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  'CAVO DI CON-NESSIONE HDMI 19 PIN TIPO A MASCHIO-MASCHIO - MT. 10 CON '
  'CONTATTI DORATI',
  'HDM0005'),
 ('LCD0010',
  'MONITOR LCD 21,5pollici; LG W2243T-PF WIDE, FULL HD, CONTRASTO 30.000:1, '
  '300CD-M, TEMPO DI RISPOSTA ',
  'DVD+R DOUBLE LAYER VERBATIM CAKE DA 10PZ',
  'MDV0005'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'LETTORE MP3 CLIP TUBE NILOX 2GB SIL-VER',
  'MP30003'),
 ('SRE0003',
  'KASPERSKY ANTIVIRUS 2011 - 3 PC VERSIONE BOXATA',
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  'NOT0001'),
 ('CTO0002',
  'CARTUCCIA TONER HP LASERJET CP 1215-1515N-1518-CM1312 CM1312NFI RIGENERATA '
  'NERO 2,2K CB540',
  'DIGICOM 8E4410 ROUTER MODEM WIRELESS, ADSL 2-2+, ACCESS POINT 802.11G, 4 '
  'PORTE 10-100',
  'NRO0005'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'DIGICOM 8E4410 ROUTER MODEM WIRELESS, ADSL 2-2+, ACCESS POINT 802.11G, 4 '
  'PORTE 10-100',
  'NRO0005'),
 ('HDM0005',
  'CAVO DI CON-NESSIONE HDMI 19 PIN TIPO A MASCHIO-MASCHIO - MT. 10 CON '
  'CONTATTI DORATI',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MBI0019',
  'SCHEDA MADRE GIGABYTE GA-H55M-D2H, SOCKET 1156, CHIPSET H55, 2XDDR3 2200+, '
  'VGA INTEGRATA, HDMI, ',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MP30003',
  'LETTORE MP3 CLIP TUBE NILOX 2GB SIL-VER',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('NOT0001',
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('NRO0002',
  'ROUTER ADSL-ADSL2 4P. E FIREWALL TP-LINK',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('STM0003',
  'STAMPANTE HP PHOTOSMART PREMIUM AIO CD055B#BGW WIRELESS',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('ZAN0007',
  'CARICABATTERIE UNIVERSALE PER NETBOOK ASUS',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'KASPERSKY ANTIVIRUS 2011 - 3 PC VERSIONE BOXATA',
  'SRE0003'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'CARICABATTERIE UNIVERSALE PER NETBOOK ASUS',
  'ZAN0007'),
 ('ZNS0001',
  'CAVO RETE UTP CAT.5E NON SCHERMATO - LUNGHEZZA MT2',
  'CAVO DI RETE UTP CAT.5E NON SCHERMATO - 5MT',
  'ZNS0002')]

4a QUANTE SONO LE CATEGORIE?
[(173,)]

4b QUALI SONO LE ULTIME 10?
[('WEBCAM',),
 ('WEBCAM',),
 ('VIDEOPROIETTORI',),
 ('VIDEOGAMES',),
 ('VIDEOGAMES',),
 ('UPS',),
 ('TONER ORIGINALI',),
 ('TONER COMPATIBILI',),
 ('TEST',),
 ('TELEVISORI LCD',)]

4c QUALI CELLULARI SONO IN MAGAZZINO?
[('CEL0001', 'NOKIA N2730 BLACK', 0),
 ('CEL0003', 'CELLULARE NOKIA 6210 NA-VIGATOR GARANZIA EUROPA', 0),
 ('CEL0004',
  'CELLULARE SAMSUNG B7722 DUAL SIM, TOUCH 3,2pollici;, FOTOCAMERA 5 MEGAPIXEL',
  0),
 ('CEL0005', 'CELLULARE NOKIA S5230 ITA BLACK', 0)]
Sono in lista, ma non sono in magazzino

4d QUALI SOFTWARE WINDOWS SONO IN MAGAZZINO?
[('SOE0001', 'WINDOWS 7 ITA PROFESSIONAL 64 BIT OEM', 0),
 ('SOE0002', 'WINDOWS 7 ITA HOME PREMIUM 64 BIT OEM', 0),
 ('SOE0004', 'WINDOWS XP PROFESSIONAL OEM EDITION', 0),
 ('SOE0006', 'WINDOWS XP HOME EDITION OEM SP3', 0),
 ('SOE0007', 'WINDOWS SERVER STANDARD 2008R2', 0),
 ('SOE0008', 'WINDOWS 7 HOME PREMIUM 32BIT OEM', 0)]
Sono in lista, ma non sono in magazzino

5a A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?
[('SOE0001', 'WINDOWS 7 ITA PROFESSIONAL 64 BIT OEM', 158.0),
 ('SOE0001', 'WINDOWS 7 ITA PROFESSIONAL 64 BIT OEM', 139.567),
 ('SOE0002', 'WINDOWS 7 ITA HOME PREMIUM 64 BIT OEM', 113.0),
 ('SOE0002', 'WINDOWS 7 ITA HOME PREMIUM 64 BIT OEM', 99.8167),
 ('SOE0004', 'WINDOWS XP PROFESSIONAL OEM EDITION', 108.0),
 ('SOE0004', 'WINDOWS XP PROFESSIONAL OEM EDITION', 95.4),
 ('SOE0006', 'WINDOWS XP HOME EDITION OEM SP3', 578.0),
 ('SOE0006', 'WINDOWS XP HOME EDITION OEM SP3', 510.567),
 ('SOE0007', 'WINDOWS SERVER STANDARD 2008R2', 964.0),
 ('SOE0007', 'WINDOWS SERVER STANDARD 2008R2', 851.533),
 ('SOE0008', 'WINDOWS 7 HOME PREMIUM 32BIT OEM', 1868.0),
 ('SOE0008', 'WINDOWS 7 HOME PREMIUM 32BIT OEM', 1650.07)]
Qui è rappresentato il valore

5b VALORE E PREZZO SONO LA STESSA COSA? ESEMPIO PER id prodotto: '4000001'
[('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 76.0),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 67.1333),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 76.0),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 67.1333),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 76.0),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 67.1333)]
Valore e prezzo non sono la stessa cosa

6 QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?
[('BOX ESTERNI MULTIMEDIALI', 1619.66748046875),
 ('COMPUTER FISSI COMPLETI', 1603.6599731445312),
 ('NETWORK ATTACHED STORAGE (NAS)', 1527.385009765625),
 ('EBOOK', 1494.4249877929688),
 ('VIDEOPROIETTORI', 1445.4599914550781),
 ('HOME VIDEO', 1440.75),
 ('SCHEDE AUDIO', 1422.8599853515625),
 ('CONSOLE E GAME', 1383.3099975585938),
 ('FOTOCAMERE COMPATTE', 1355.0599975585938),
 ('HARD DISK IDE 3,5pollici', 1285.8450012207031),
 ('RICAMBI LCD', 1283.679296875),
 ("GRUPPI DI CONTINUITA'", 1268.2371978759766),
 ('COMPACT FLASH', 1267.4824981689453),
 ('CONSOLE', 1244.885009765625),
 ('LETTORI MP3/MP4', 1240.6466674804688),
 ('CASSE ACUSTICHE', 1228.8748196688566),
 ('TASTIERE', 1204.6739959716797),
 ('LETTORI DVD/CD', 1204.3900146484375),
 ('SWITCH DI RETE', 1188.6191329956055),
 ('ACCESS POINT E PERIFERICHE WIRELESS', 1154.169558207194),
 ('MOUSE', 1141.8580512294063),
 ('CD', 1131.4122517903645),
 ('CUSTODIE', 1127.1741689046223),
 ('VIDEOGAMES', 1112.421989695231),
 ('PEN DRIVE', 1094.5693674087524),
 ('NOTEBOOK', 1092.1194983395662),
 ('SDRAM PC133', 1088.0967559814453),
 ('MEMORIE SD, MINI SD E MICRO SD', 1078.2083367241753),
 ('TONER COMPATIBILI', 1061.070294189453),
 ('SCHEDE DI RETE', 1046.1914978027344),
 ('CASSETTINI ESTERNI PER HD', 1042.6868548923069),
 ('TONER ORIGINALI', 1029.3361534118653),
 ('MASTERIZZATORI', 1024.0198579268022),
 ('LETTORI DI CARD INTERNI', 1018.8829956054688),
 ('CARTUCCE ORIGINALI', 1017.6883742992694),
 ('HARD DISK SATA 3,5pollici', 1016.1401735388714),
 ('STAMPANTI MULTIFUNZIONE INKJET', 999.5794982910156),
 ('ALIMENTATORI', 997.3333971683795),
 ('MAINBOARD AMD', 997.2661668943322),
 ('MASTERIZZATORI SLIM', 993.8345962524414),
 ('ACCESSORI USB', 986.3967514038086),
 ('CAVETTERIA', 981.5638153678492),
 ('CELLULARI', 953.2016315460205),
 ('MASTERIZZATORI ESTERNI', 945.9037475585938),
 ('COMPONENTI CONSOLE', 945.1974945068359),
 ('ACCESSORI VARI', 941.9669588844248),
 ('RAM DDR2', 941.0675014149059),
 ('CASE', 936.632647220905),
 ('JOYPAD', 934.6050271987915),
 ('SERVIZI ASSISTENZA', 931.3939167369496),
 ('PROCESSORI AMD', 915.9278767585754),
 ('CARTUCCE COMPATIBILI', 906.3069692611695),
 ('ROUTER', 898.949534329501),
 ('RAM DDR3', 898.2646744467995),
 ('DVD', 894.583609008789),
 ('HARD DISK 2,5pollici', 894.5834633963449),
 ('RAM DDR 400', 889.6058872767857),
 ('PROCESSORI INTEL', 885.1038668314616),
 ('MAINBOARD INTEL', 874.8806954530569),
 ('MONITOR LCD E LED', 834.7711968915216),
 ('BORSE NOTEBOOK', 820.0572139195034),
 ('STAMPANTI INKJET', 807.9500122070312),
 ('MEMORY STICK', 793.1971638997396),
 ('COMPUTER ASSITECH PRE-ASSEMBLATI', 782.0540008544922),
 ('NETBOOK', 778.476097869873),
 ('SOFTWARE RETAIL', 765.9515954971314),
 ('MONITOR TV LCD', 731.2039947509766),
 ('SO-DIMM PER NOTEBOOK', 679.0003209114075),
 ('HARD DISK ESTERNI', 670.3723487854004),
 ('SOFTWARE MICROSOFT', 619.9700403213501),
 ('STAMPANTI LASER B/N', 602.9021285772324),
 ('DVD DUAL LAYER', 570.6495081583658),
 ('MODEM ADSL USB', 557.7021255493164),
 ('LETTORE FLOPPY', 482.1334991455078),
 ('FILTRI ADSL', 351.7125015258789),
 ('TABLET PC', 342.76649475097656),
 ('RISCRIVIBILI', 320.16650390625),
 ('SCHEDE DI ACQUISIZIONE', 314.51649475097656),
 ('SERVER', 118.6500015258789),
 ('PERIFERICHE GAMING', 116.76649856567383),
 ('STAMPANTI LASER A COLORI', 106.87917518615723)]

7a QUANTI PRODOTTI CI SONO PER CATEGORIA?
[('ACCESSORI VARI', 75),
 ('CAVETTERIA', 38),
 ('MONITOR LCD E LED', 29),
 ('MOUSE', 27),
 ('MAINBOARD INTEL', 26),
 ('CARTUCCE ORIGINALI', 26),
 ('ALIMENTATORI', 26),
 ('CASE', 26),
 ('MAINBOARD AMD', 23),
 ('HARD DISK SATA 3,5pollici', 23),
 ('NOTEBOOK', 22),
 ('CARTUCCE COMPATIBILI', 20),
 ('CASSETTINI ESTERNI PER HD', 18),
 ('SO-DIMM PER NOTEBOOK', 16),
 ('ACCESS POINT E PERIFERICHE WIRELESS', 15),
 ('PROCESSORI AMD', 15),
 ('PROCESSORI INTEL', 15),
 ('VIDEOGAMES', 15),
 ('HARD DISK 2,5pollici', 14),
 ('ROUTER', 11),
 ('MASTERIZZATORI', 11),
 ('CASSE ACUSTICHE', 11),
 ('RAM DDR3', 11),
 ('RAM DDR2', 11),
 ('SERVIZI ASSISTENZA', 11),
 ('NETBOOK', 10),
 ('TASTIERE', 10),
 ("GRUPPI DI CONTINUITA'", 10),
 ('HARD DISK ESTERNI', 10),
 ('TONER ORIGINALI', 10),
 ('MEMORIE SD, MINI SD E MICRO SD', 9),
 ('PEN DRIVE', 8),
 ('SOFTWARE MICROSOFT', 8),
 ('RAM DDR 400', 7),
 ('BORSE NOTEBOOK', 7),
 ('STAMPANTI MULTIFUNZIONE INKJET', 6),
 ('CUSTODIE', 6),
 ('CD', 6),
 ('SOFTWARE RETAIL', 5),
 ('DVD', 5),
 ('RICAMBI LCD', 5),
 ('TONER COMPATIBILI', 5),
 ('MASTERIZZATORI SLIM', 5),
 ('LETTORI MP3/MP4', 4),
 ('SWITCH DI RETE', 4),
 ('STAMPANTI LASER B/N', 4),
 ('LETTORI DI CARD INTERNI', 4),
 ('MODEM ADSL USB', 4),
 ('CELLULARI', 4),
 ('JOYPAD', 4),
 ('COMPONENTI CONSOLE', 4),
 ('MASTERIZZATORI ESTERNI', 4),
 ('DVD DUAL LAYER', 3),
 ('MEMORY STICK', 3),
 ('SCHEDE AUDIO', 2),
 ('COMPUTER ASSITECH PRE-ASSEMBLATI', 2),
 ('VIDEOPROIETTORI', 2),
 ('ACCESSORI USB', 2),
 ('HARD DISK IDE 3,5pollici', 2),
 ('FILTRI ADSL', 2),
 ('BOX ESTERNI MULTIMEDIALI', 2),
 ('STAMPANTI LASER A COLORI', 2),
 ('SDRAM PC133', 2),
 ('COMPACT FLASH', 2),
 ('MONITOR TV LCD', 2),
 ('CONSOLE E GAME', 1),
 ('STAMPANTI INKJET', 1),
 ('EBOOK', 1),
 ('LETTORE FLOPPY', 1),
 ('SERVER', 1),
 ('RISCRIVIBILI', 1),
 ('PERIFERICHE GAMING', 1),
 ('COMPUTER FISSI COMPLETI', 1),
 ('HOME VIDEO', 1),
 ('LETTORI DVD/CD', 1),
 ('SCHEDE DI RETE', 1),
 ('SCHEDE DI ACQUISIZIONE', 1),
 ('TABLET PC', 1),
 ('NETWORK ATTACHED STORAGE (NAS)', 1),
 ('CONSOLE', 1),
 ('FOTOCAMERE COMPATTE', 1)]

7b QUANTI PRODOTTI CI SONO PER MARCA?
[('ASUS', 31),
 ('ITEK', 28),
 ('HP', 24),
 ('SAMSUNG', 21),
 ('ACER', 17),
 ('WESTERN DIGI-TAL', 16),
 ('TP-LINK', 16),
 ('ASROCK', 16),
 ('EPSON', 15),
 ('KING-STON', 14),
 ('AMD', 14),
 ('INTEL', 14),
 ('DIGITUS', 12),
 ('VERBATIM', 10),
 ('LOGITECH', 10),
 ('MICROSOFT', 9),
 ('CORSAIR', 9),
 ('PHILIPS', 8),
 ('GIGABYTE', 8),
 ('SEAGATE', 8),
 ('NILOX', 7),
 ('BENQ', 7),
 ('SONY', 6),
 ('LINQ', 5),
 ('SANDISK', 5),
 ('TECHSOLO', 5),
 ('SHINTEK', 4),
 ('LG', 4),
 ('A-DA-TA', 4),
 ('GEIL', 4),
 ('KASPER-SKY', 3),
 ('CAPTI-VA', 3),
 ('COOLER MA-STER', 3),
 ('MAXTOR', 3),
 ('LC PO-WER', 3),
 ('HITACHI', 3),
 ('NOKIA', 3),
 ('TOSHIBA', 3),
 ('LENOVO', 3),
 ('OK TECH', 3),
 ('POWESTOK UPS', 3),
 ('SILICON PO-WER', 3),
 ('MUSKIN', 2),
 ('TECNOWARE', 2),
 ('ALCATEL', 2),
 ('CREATIVE', 2),
 ('ASSITECH', 2),
 ('HANTOL', 2),
 ('PATRIOT', 2),
 ('LEXMARK', 2),
 ('KODAK', 2),
 ('FUJITSU', 2),
 ('HANNSPREE', 2),
 ('CA-NYON', 2),
 ('TEAC', 2),
 ('BROTHER', 1),
 ('CONCEPTRONIC', 1),
 ('WACOM', 1),
 ('SAPPHIRE', 1),
 ('V-DA-TA', 1),
 ('D-LINK', 1),
 ('KENSINGTON', 1),
 ('LINKSYS', 1),
 ('TRAXDATA', 1),
 ('ANTEG', 1),
 ('ENERMAX', 1),
 ('MACH PO-WER', 1),
 ('MSI', 1),
 ('BUFFALO', 1),
 ('MAX FLA-SH', 1),
 ('LOGILINK', 1),
 ('APPLE', 1),
 ('EXCELERAM', 1),
 ('NIKON', 1),
 ('FORTIS', 1),
 ('GEMBIRD', 1),
 ('TRASCEND', 1)]

8a QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA'?
[('DR20008',
  2,
  'DIMM DDRII PC533 1GB CL4.0 KINGSTON',
  100,
  Decimal('12'),
  283.9199981689453,
  23.66),
 ('MBI0013',
  3,
  'SCHEDA MADRE ASROCK G41C-S, MICRO ATX, SOCKET 775, FSB1333-1066-800-533 '
  'MHZ, 2XDDR3  1333 E 2XDDR2 ',
  100,
  Decimal('11'),
  438.90001678466797,
  39.9),
 ('ACC0007',
  1,
  'MODULA PLUG 30Upollici; GLOD PLA-TED',
  130,
  Decimal('10'),
  1.899999976158142,
  0.19),
 ('4000001', 1, 'DIMM 1GB PC400 DDR KING-STON', 100, Decimal('7'), 227.5, 32.5),
 ('CIN0018',
  2,
  'CARTUCCIA CANON CL41',
  100,
  Decimal('7'),
  145.66999626159668,
  20.81),
 ('ZAN0007',
  1,
  'CARICABATTERIE UNIVERSALE PER NETBOOK ASUS',
  100,
  Decimal('6'),
  179.39999771118164,
  29.9)]
1: DIMM DDRII
2: SCHEDA MADRE ASROCK
3: MODULA PLUG
4: CARTUCCIA CANON
5: CARICABATTERIE UNIVERSALE

8b QUALI SONO I 5 PRODOTTI BESTSELLER PER GUADAGNO?
[('NOT0001',
  4,
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  100,
  Decimal('2'),
  923.219970703125,
  461.61),
 ('LCD0001',
  3,
  'MONITOR LCD 19 POLLICI LG W1943SS-PF',
  100,
  Decimal('6'),
  586.5600128173828,
  97.76),
 ('MBI0013',
  3,
  'SCHEDA MADRE ASROCK G41C-S, MICRO ATX, SOCKET 775, FSB1333-1066-800-533 '
  'MHZ, 2XDDR3  1333 E 2XDDR2 ',
  100,
  Decimal('11'),
  438.90001678466797,
  39.9),
 ('MBA0016',
  3,
  'SCHEDA MADRE AM3 GIGABYTE GA-M52LT-D3, CHIPSET NVIDIA NFORCE 520LE, 4XDDR3 '
  '1666+-1333-1066 MHZ, ',
  100,
  Decimal('6'),
  302.09999084472656,
  50.35),
 ('CTO0011',
  23,
  'TONER ORIGINALE HP CE505A NERO PER STAMPANTI P2035-P2055',
  100,
  Decimal('4'),
  285.0,
  71.25)]
1: ACER AS5810T-354G32MN
2: MONITOR LCD LG
3: SCHEDA MADRE ASROCK
4: SCHEDA MADRE AM3
5: TONER HP

9 QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?
[(12, 'Consegna con corriere GLS', 9.9, 118.79999542236328, 'Contrassegno', 5.0, 60.0), (2, 'Consegna con corriere GLS', 9.9, 19.799999237060547, 'Pagamento con Carta di Credito', 0.0, 0.0), (3, 'Spedizione in posta', 31.0, 93.0, 'Contrassegno', 5.0, 15.0), (8, 'Spedizione in posta', 31.0, 248.0, 'Pagamento con Carta di Credito', 0.0, 0.0)]
Metodo spedizione: Consegna con corriere GLS = 14; Spedizione in posta = 11;
Metodo di pagamento: Contrassegno = 15; Pagamento con Carta di Credito = 10;

10a A QUALI CITTA SI SPEDISCE DI PIU'?
[('Cosenza', 'Cosenza', 2),
 ('Cosenza', 'Castrovillari', 1),
 ('Milano', 'Milano', 6),
 ('Milano', 'Cologno Monzese', 1),
 ('Milano', 'Assago', 1),
 ('Pistoia', 'Pistoia', 3),
 ('Pistoia', 'Massa e Cozzile', 1),
 ('Reggio Calabria', 'Gallico Superio-re', 1),
 ('Roma', 'Roma', 10),
 ('Roma', 'Frascati', 1),
 ('Roma', 'Nettuno', 1)]
Città: Roma, Milano

10b A QUALI PROVINCE SI SPEDISCE DI PIU'?
[('Roma', 12),
 ('Milano', 8),
 ('Pistoia', 4),
 ('Cosenza', 3),
 ('Reggio Calabria', 1)]
Province: Roma, Milano

Process finished with exit code 0
```

```
C:\Users\elste\Desktop\epicode\Scripts\python.exe "C:\Users\elste\Desktop\epicode\3_Week\Day 4\3.4 Progetto pt 1 - Cursori.py" 

1 QUALI TABELLE SONO NEL DATABASE ecommerce?
[('categoria',),
 ('correlati',),
 ('immagine',),
 ('indirizzo',),
 ('listino',),
 ('livello',),
 ('marca',),
 ('ordine',),
 ('orpr01',),
 ('pagamento',),
 ('pasp01',),
 ('prezzo',),
 ('prim01',),
 ('prodotto',),
 ('spedizione',),
 ('stato',),
 ('subcat',),
 ('utente',)]

2a QUANTE MARCHE SONO VENDUTE NEL ecommerce?
[(89,)]

2b QUALI MARCHE SONO VENDUTE NEL ecommerce?
[('XFX',),
 ('WESTERN DIGI-TAL',),
 ('WACOM',),
 ('VERBATIM',),
 ('V-DA-TA',),
 ('TWINTECH',),
 ('TRAXDATA',),
 ('TRASCEND',),
 ('TP-LINK',),
 ('TOSHIBA',)]

3a QUANTI PRODOTTI SONO IN LISTA?
[(747,)]

3b QUANTI PRODOTTI SONO IN MAGAZZINO?
[(184,)]

3c QUALI SONO I PRIMI 5 PRODOTTI?
[('ACCESS POINT TP-LINK 108MBPS AH300350T SUPPORTA IEEE802.11G, IEEEE802.11B, '
  'EEE802.3, IEEE802.3U',),
 ('ACCESS POINT TP-LINK TL-WA500G, 54MBPS, SUPPORTS WDS, SUPPORTS AP-AP ',),
 ('ACCESS POINT TP-LINK TL-WA901ND, 300MBPS, POTENZA 20DBM (MAX), REPEATER, '
  'BRIDGE',),
 ('ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',),
 ('ACER ASPIRE 5736Z-453G32MNKK (LX.R7Z02.003), DUAL CORE T4500, 3GB DI RAM, '
  '320GB SATA, WIRELESS, DVD ',)]

3d QUALI PRODOTTI SONO CORRELATI?
[('4000007',
  'DIMM NILOX MN1004 1GB DDR 400MHZ PC-3200',
  'RAM DDR 400 PC3200 CORSAIR 1GB VS1GB400C3',
  '4000006'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'BATTERIA TAMPONE AL LITIO 3 VOLT A BOTTONE IEC TYP CR2032, DL2032, 5004LX, '
  'E-CR2032',
  'ACC0013'),
 ('ACC0032',
  'CUFFIE SHIN-TEK FHS16215 JOCKEY BLACK',
  'ADATTATORE HOST IDE-SATA INTER-NO',
  'ACC0033'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'ALIMENTATORE 500W AMD-INTEL 20-24 PIN VENTOLA SILENT',
  'ALI0001'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'ALIMENTATORE INTER-TECH SL-700 700W SILENT',
  'ALI0012'),
 ('ZNS0001',
  'CAVO RETE UTP CAT.5E NON SCHERMATO - LUNGHEZZA MT2',
  'ALIMENTATORE INTER-TECH SL-700 700W SILENT',
  'ALI0012'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'CASE MID 500W ITEK SPA-CE',
  'CAS0016'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'CARTUCCIA HP 88 (C9388AE) GIALLO PER STAMPANTI K550XI DTN, PRO K5300, PRO '
  'K5400, PRO K5400DN, PRO ',
  'CIN0024'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'HARD DISK ESTERNO 3,5pollici; WESTERN DIGITAL 1TB WDBAAU0010HBK',
  'HDE0003'),
 ('NOT0001',
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  'CAVO DI CON-NESSIONE HDMI 19 PIN TIPO A MASCHIO-MASCHIO - MT. 10 CON '
  'CONTATTI DORATI',
  'HDM0005'),
 ('LCD0010',
  'MONITOR LCD 21,5pollici; LG W2243T-PF WIDE, FULL HD, CONTRASTO 30.000:1, '
  '300CD-M, TEMPO DI RISPOSTA ',
  'DVD+R DOUBLE LAYER VERBATIM CAKE DA 10PZ',
  'MDV0005'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'LETTORE MP3 CLIP TUBE NILOX 2GB SIL-VER',
  'MP30003'),
 ('SRE0003',
  'KASPERSKY ANTIVIRUS 2011 - 3 PC VERSIONE BOXATA',
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  'NOT0001'),
 ('CTO0002',
  'CARTUCCIA TONER HP LASERJET CP 1215-1515N-1518-CM1312 CM1312NFI RIGENERATA '
  'NERO 2,2K CB540',
  'DIGICOM 8E4410 ROUTER MODEM WIRELESS, ADSL 2-2+, ACCESS POINT 802.11G, 4 '
  'PORTE 10-100',
  'NRO0005'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'DIGICOM 8E4410 ROUTER MODEM WIRELESS, ADSL 2-2+, ACCESS POINT 802.11G, 4 '
  'PORTE 10-100',
  'NRO0005'),
 ('HDM0005',
  'CAVO DI CON-NESSIONE HDMI 19 PIN TIPO A MASCHIO-MASCHIO - MT. 10 CON '
  'CONTATTI DORATI',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MBI0019',
  'SCHEDA MADRE GIGABYTE GA-H55M-D2H, SOCKET 1156, CHIPSET H55, 2XDDR3 2200+, '
  'VGA INTEGRATA, HDMI, ',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MP30003',
  'LETTORE MP3 CLIP TUBE NILOX 2GB SIL-VER',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('NOT0001',
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('NRO0002',
  'ROUTER ADSL-ADSL2 4P. E FIREWALL TP-LINK',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('STM0003',
  'STAMPANTE HP PHOTOSMART PREMIUM AIO CD055B#BGW WIRELESS',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('ZAN0007',
  'CARICABATTERIE UNIVERSALE PER NETBOOK ASUS',
  'SO-DIMM DDR PC400 1GB CL3 CORSAIR',
  'SDD0007'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'KASPERSKY ANTIVIRUS 2011 - 3 PC VERSIONE BOXATA',
  'SRE0003'),
 ('MOU0006',
  'MOUSE HANTOL PLUS CON CONNETTORE PS2',
  'CARICABATTERIE UNIVERSALE PER NETBOOK ASUS',
  'ZAN0007'),
 ('ZNS0001',
  'CAVO RETE UTP CAT.5E NON SCHERMATO - LUNGHEZZA MT2',
  'CAVO DI RETE UTP CAT.5E NON SCHERMATO - 5MT',
  'ZNS0002')]

4a QUANTE SONO LE CATEGORIE?
[(173,)]

4b QUALI SONO LE ULTIME 10?
[('WEBCAM',),
 ('WEBCAM',),
 ('VIDEOPROIETTORI',),
 ('VIDEOGAMES',),
 ('VIDEOGAMES',),
 ('UPS',),
 ('TONER ORIGINALI',),
 ('TONER COMPATIBILI',),
 ('TEST',),
 ('TELEVISORI LCD',)]

4c QUALI CELLULARI SONO IN MAGAZZINO?
[('CEL0001', 'NOKIA N2730 BLACK', 0),
 ('CEL0003', 'CELLULARE NOKIA 6210 NA-VIGATOR GARANZIA EUROPA', 0),
 ('CEL0004',
  'CELLULARE SAMSUNG B7722 DUAL SIM, TOUCH 3,2pollici;, FOTOCAMERA 5 MEGAPIXEL',
  0),
 ('CEL0005', 'CELLULARE NOKIA S5230 ITA BLACK', 0)]
Sono in lista, ma non sono in magazzino

4d QUALI SOFTWARE WINDOWS SONO IN MAGAZZINO?
[('SOE0001', 'WINDOWS 7 ITA PROFESSIONAL 64 BIT OEM', 0),
 ('SOE0002', 'WINDOWS 7 ITA HOME PREMIUM 64 BIT OEM', 0),
 ('SOE0004', 'WINDOWS XP PROFESSIONAL OEM EDITION', 0),
 ('SOE0006', 'WINDOWS XP HOME EDITION OEM SP3', 0),
 ('SOE0007', 'WINDOWS SERVER STANDARD 2008R2', 0),
 ('SOE0008', 'WINDOWS 7 HOME PREMIUM 32BIT OEM', 0)]
Sono in lista, ma non sono in magazzino

5a A QUANTO SONO VENDUTI I SOFTWARE WINDOWS?
[('SOE0001', 'WINDOWS 7 ITA PROFESSIONAL 64 BIT OEM', 158.0),
 ('SOE0001', 'WINDOWS 7 ITA PROFESSIONAL 64 BIT OEM', 139.567),
 ('SOE0002', 'WINDOWS 7 ITA HOME PREMIUM 64 BIT OEM', 113.0),
 ('SOE0002', 'WINDOWS 7 ITA HOME PREMIUM 64 BIT OEM', 99.8167),
 ('SOE0004', 'WINDOWS XP PROFESSIONAL OEM EDITION', 108.0),
 ('SOE0004', 'WINDOWS XP PROFESSIONAL OEM EDITION', 95.4),
 ('SOE0006', 'WINDOWS XP HOME EDITION OEM SP3', 578.0),
 ('SOE0006', 'WINDOWS XP HOME EDITION OEM SP3', 510.567),
 ('SOE0007', 'WINDOWS SERVER STANDARD 2008R2', 964.0),
 ('SOE0007', 'WINDOWS SERVER STANDARD 2008R2', 851.533),
 ('SOE0008', 'WINDOWS 7 HOME PREMIUM 32BIT OEM', 1868.0),
 ('SOE0008', 'WINDOWS 7 HOME PREMIUM 32BIT OEM', 1650.07)]
Qui è rappresentato il valore

5b VALORE E PREZZO SONO LA STESSA COSA? ESEMPIO PER id prodotto: '4000001'
[('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 76.0),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 67.1333),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 76.0),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 67.1333),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 76.0),
 ('4000001', 'DIMM 1GB PC400 DDR KING-STON', 32.5, 67.1333)]
Valore e prezzo non sono la stessa cosa

6 QUANTO VALORE HANNO IN MEDIA I PRODOTTI PER CATEGORIA?
[('BOX ESTERNI MULTIMEDIALI', 1619.66748046875),
 ('COMPUTER FISSI COMPLETI', 1603.6599731445312),
 ('NETWORK ATTACHED STORAGE (NAS)', 1527.385009765625),
 ('EBOOK', 1494.4249877929688),
 ('VIDEOPROIETTORI', 1445.4599914550781),
 ('HOME VIDEO', 1440.75),
 ('SCHEDE AUDIO', 1422.8599853515625),
 ('CONSOLE E GAME', 1383.3099975585938),
 ('FOTOCAMERE COMPATTE', 1355.0599975585938),
 ('HARD DISK IDE 3,5pollici', 1285.8450012207031),
 ('RICAMBI LCD', 1283.679296875),
 ("GRUPPI DI CONTINUITA'", 1268.2371978759766),
 ('COMPACT FLASH', 1267.4824981689453),
 ('CONSOLE', 1244.885009765625),
 ('LETTORI MP3/MP4', 1240.6466674804688),
 ('CASSE ACUSTICHE', 1228.8748196688566),
 ('TASTIERE', 1204.6739959716797),
 ('LETTORI DVD/CD', 1204.3900146484375),
 ('SWITCH DI RETE', 1188.6191329956055),
 ('ACCESS POINT E PERIFERICHE WIRELESS', 1154.169558207194),
 ('MOUSE', 1141.8580512294063),
 ('CD', 1131.4122517903645),
 ('CUSTODIE', 1127.1741689046223),
 ('VIDEOGAMES', 1112.421989695231),
 ('PEN DRIVE', 1094.5693674087524),
 ('NOTEBOOK', 1092.1194983395662),
 ('SDRAM PC133', 1088.0967559814453),
 ('MEMORIE SD, MINI SD E MICRO SD', 1078.2083367241753),
 ('TONER COMPATIBILI', 1061.070294189453),
 ('SCHEDE DI RETE', 1046.1914978027344),
 ('CASSETTINI ESTERNI PER HD', 1042.6868548923069),
 ('TONER ORIGINALI', 1029.3361534118653),
 ('MASTERIZZATORI', 1024.0198579268022),
 ('LETTORI DI CARD INTERNI', 1018.8829956054688),
 ('CARTUCCE ORIGINALI', 1017.6883742992694),
 ('HARD DISK SATA 3,5pollici', 1016.1401735388714),
 ('STAMPANTI MULTIFUNZIONE INKJET', 999.5794982910156),
 ('ALIMENTATORI', 997.3333971683795),
 ('MAINBOARD AMD', 997.2661668943322),
 ('MASTERIZZATORI SLIM', 993.8345962524414),
 ('ACCESSORI USB', 986.3967514038086),
 ('CAVETTERIA', 981.5638153678492),
 ('CELLULARI', 953.2016315460205),
 ('MASTERIZZATORI ESTERNI', 945.9037475585938),
 ('COMPONENTI CONSOLE', 945.1974945068359),
 ('ACCESSORI VARI', 941.9669588844248),
 ('RAM DDR2', 941.0675014149059),
 ('CASE', 936.632647220905),
 ('JOYPAD', 934.6050271987915),
 ('SERVIZI ASSISTENZA', 931.3939167369496),
 ('PROCESSORI AMD', 915.9278767585754),
 ('CARTUCCE COMPATIBILI', 906.3069692611695),
 ('ROUTER', 898.949534329501),
 ('RAM DDR3', 898.2646744467995),
 ('DVD', 894.583609008789),
 ('HARD DISK 2,5pollici', 894.5834633963449),
 ('RAM DDR 400', 889.6058872767857),
 ('PROCESSORI INTEL', 885.1038668314616),
 ('MAINBOARD INTEL', 874.8806954530569),
 ('MONITOR LCD E LED', 834.7711968915216),
 ('BORSE NOTEBOOK', 820.0572139195034),
 ('STAMPANTI INKJET', 807.9500122070312),
 ('MEMORY STICK', 793.1971638997396),
 ('COMPUTER ASSITECH PRE-ASSEMBLATI', 782.0540008544922),
 ('NETBOOK', 778.476097869873),
 ('SOFTWARE RETAIL', 765.9515954971314),
 ('MONITOR TV LCD', 731.2039947509766),
 ('SO-DIMM PER NOTEBOOK', 679.0003209114075),
 ('HARD DISK ESTERNI', 670.3723487854004),
 ('SOFTWARE MICROSOFT', 619.9700403213501),
 ('STAMPANTI LASER B/N', 602.9021285772324),
 ('DVD DUAL LAYER', 570.6495081583658),
 ('MODEM ADSL USB', 557.7021255493164),
 ('LETTORE FLOPPY', 482.1334991455078),
 ('FILTRI ADSL', 351.7125015258789),
 ('TABLET PC', 342.76649475097656),
 ('RISCRIVIBILI', 320.16650390625),
 ('SCHEDE DI ACQUISIZIONE', 314.51649475097656),
 ('SERVER', 118.6500015258789),
 ('PERIFERICHE GAMING', 116.76649856567383),
 ('STAMPANTI LASER A COLORI', 106.87917518615723)]

7a QUANTI PRODOTTI CI SONO PER CATEGORIA?
[('ACCESSORI VARI', 75),
 ('CAVETTERIA', 38),
 ('MONITOR LCD E LED', 29),
 ('MOUSE', 27),
 ('MAINBOARD INTEL', 26),
 ('CARTUCCE ORIGINALI', 26),
 ('ALIMENTATORI', 26),
 ('CASE', 26),
 ('MAINBOARD AMD', 23),
 ('HARD DISK SATA 3,5pollici', 23),
 ('NOTEBOOK', 22),
 ('CARTUCCE COMPATIBILI', 20),
 ('CASSETTINI ESTERNI PER HD', 18),
 ('SO-DIMM PER NOTEBOOK', 16),
 ('ACCESS POINT E PERIFERICHE WIRELESS', 15),
 ('PROCESSORI AMD', 15),
 ('PROCESSORI INTEL', 15),
 ('VIDEOGAMES', 15),
 ('HARD DISK 2,5pollici', 14),
 ('ROUTER', 11),
 ('MASTERIZZATORI', 11),
 ('CASSE ACUSTICHE', 11),
 ('RAM DDR3', 11),
 ('RAM DDR2', 11),
 ('SERVIZI ASSISTENZA', 11),
 ('NETBOOK', 10),
 ('TASTIERE', 10),
 ("GRUPPI DI CONTINUITA'", 10),
 ('HARD DISK ESTERNI', 10),
 ('TONER ORIGINALI', 10),
 ('MEMORIE SD, MINI SD E MICRO SD', 9),
 ('PEN DRIVE', 8),
 ('SOFTWARE MICROSOFT', 8),
 ('RAM DDR 400', 7),
 ('BORSE NOTEBOOK', 7),
 ('STAMPANTI MULTIFUNZIONE INKJET', 6),
 ('CUSTODIE', 6),
 ('CD', 6),
 ('SOFTWARE RETAIL', 5),
 ('DVD', 5),
 ('RICAMBI LCD', 5),
 ('TONER COMPATIBILI', 5),
 ('MASTERIZZATORI SLIM', 5),
 ('LETTORI MP3/MP4', 4),
 ('SWITCH DI RETE', 4),
 ('STAMPANTI LASER B/N', 4),
 ('LETTORI DI CARD INTERNI', 4),
 ('MODEM ADSL USB', 4),
 ('CELLULARI', 4),
 ('JOYPAD', 4),
 ('COMPONENTI CONSOLE', 4),
 ('MASTERIZZATORI ESTERNI', 4),
 ('DVD DUAL LAYER', 3),
 ('MEMORY STICK', 3),
 ('SCHEDE AUDIO', 2),
 ('COMPUTER ASSITECH PRE-ASSEMBLATI', 2),
 ('VIDEOPROIETTORI', 2),
 ('ACCESSORI USB', 2),
 ('HARD DISK IDE 3,5pollici', 2),
 ('FILTRI ADSL', 2),
 ('BOX ESTERNI MULTIMEDIALI', 2),
 ('STAMPANTI LASER A COLORI', 2),
 ('SDRAM PC133', 2),
 ('COMPACT FLASH', 2),
 ('MONITOR TV LCD', 2),
 ('CONSOLE E GAME', 1),
 ('STAMPANTI INKJET', 1),
 ('EBOOK', 1),
 ('LETTORE FLOPPY', 1),
 ('SERVER', 1),
 ('RISCRIVIBILI', 1),
 ('PERIFERICHE GAMING', 1),
 ('COMPUTER FISSI COMPLETI', 1),
 ('HOME VIDEO', 1),
 ('LETTORI DVD/CD', 1),
 ('SCHEDE DI RETE', 1),
 ('SCHEDE DI ACQUISIZIONE', 1),
 ('TABLET PC', 1),
 ('NETWORK ATTACHED STORAGE (NAS)', 1),
 ('CONSOLE', 1),
 ('FOTOCAMERE COMPATTE', 1)]
```
![](https://github.com/stefanogrillo/Data-Analyst---Epicode/blob/a04944701da5f4d3557b0cea1be1ae3f0d211a8d/Week%203/3.4%20Progetto/Barplot_sql7a.png)

```
7b QUANTI PRODOTTI CI SONO PER MARCA?
[('ASUS', 31),
 ('ITEK', 28),
 ('HP', 24),
 ('SAMSUNG', 21),
 ('ACER', 17),
 ('WESTERN DIGI-TAL', 16),
 ('TP-LINK', 16),
 ('ASROCK', 16),
 ('EPSON', 15),
 ('KING-STON', 14),
 ('AMD', 14),
 ('INTEL', 14),
 ('DIGITUS', 12),
 ('VERBATIM', 10),
 ('LOGITECH', 10),
 ('MICROSOFT', 9),
 ('CORSAIR', 9),
 ('PHILIPS', 8),
 ('GIGABYTE', 8),
 ('SEAGATE', 8),
 ('NILOX', 7),
 ('BENQ', 7),
 ('SONY', 6),
 ('LINQ', 5),
 ('SANDISK', 5),
 ('TECHSOLO', 5),
 ('SHINTEK', 4),
 ('LG', 4),
 ('A-DA-TA', 4),
 ('GEIL', 4),
 ('KASPER-SKY', 3),
 ('CAPTI-VA', 3),
 ('COOLER MA-STER', 3),
 ('MAXTOR', 3),
 ('LC PO-WER', 3),
 ('HITACHI', 3),
 ('NOKIA', 3),
 ('TOSHIBA', 3),
 ('LENOVO', 3),
 ('OK TECH', 3),
 ('POWESTOK UPS', 3),
 ('SILICON PO-WER', 3),
 ('MUSKIN', 2),
 ('TECNOWARE', 2),
 ('ALCATEL', 2),
 ('CREATIVE', 2),
 ('ASSITECH', 2),
 ('HANTOL', 2),
 ('PATRIOT', 2),
 ('LEXMARK', 2),
 ('KODAK', 2),
 ('FUJITSU', 2),
 ('HANNSPREE', 2),
 ('CA-NYON', 2),
 ('TEAC', 2),
 ('BROTHER', 1),
 ('CONCEPTRONIC', 1),
 ('WACOM', 1),
 ('SAPPHIRE', 1),
 ('V-DA-TA', 1),
 ('D-LINK', 1),
 ('KENSINGTON', 1),
 ('LINKSYS', 1),
 ('TRAXDATA', 1),
 ('ANTEG', 1),
 ('ENERMAX', 1),
 ('MACH PO-WER', 1),
 ('MSI', 1),
 ('BUFFALO', 1),
 ('MAX FLA-SH', 1),
 ('LOGILINK', 1),
 ('APPLE', 1),
 ('EXCELERAM', 1),
 ('NIKON', 1),
 ('FORTIS', 1),
 ('GEMBIRD', 1),
 ('TRASCEND', 1)]
```

![](https://github.com/stefanogrillo/Data-Analyst---Epicode/blob/a04944701da5f4d3557b0cea1be1ae3f0d211a8d/Week%203/3.4%20Progetto/Barplot_sql7b.png)

```
8a QUALI SONO I 5 PRODOTTI BESTSELLER PER QUANTITA'?
[('DR20008',
  2,
  'DIMM DDRII PC533 1GB CL4.0 KINGSTON',
  100,
  Decimal('12'),
  283.9199981689453,
  23.66),
 ('MBI0013',
  3,
  'SCHEDA MADRE ASROCK G41C-S, MICRO ATX, SOCKET 775, FSB1333-1066-800-533 '
  'MHZ, 2XDDR3  1333 E 2XDDR2 ',
  100,
  Decimal('11'),
  438.90001678466797,
  39.9),
 ('ACC0007',
  1,
  'MODULA PLUG 30Upollici; GLOD PLA-TED',
  130,
  Decimal('10'),
  1.899999976158142,
  0.19),
 ('4000001', 1, 'DIMM 1GB PC400 DDR KING-STON', 100, Decimal('7'), 227.5, 32.5),
 ('CIN0018',
  2,
  'CARTUCCIA CANON CL41',
  100,
  Decimal('7'),
  145.66999626159668,
  20.81),
 ('ZAN0007',
  1,
  'CARICABATTERIE UNIVERSALE PER NETBOOK ASUS',
  100,
  Decimal('6'),
  179.39999771118164,
  29.9)]
1: DIMM DDRII
2: SCHEDA MADRE ASROCK
3: MODULA PLUG
4: CARTUCCIA CANON
5: CARICABATTERIE UNIVERSALE

8b QUALI SONO I 5 PRODOTTI BESTSELLER PER GUADAGNO?
[('NOT0001',
  4,
  'ACER AS5810T-354G32MN, LX.PBB0X.144, 15.6pollici; LED CB, INTEL CORE 2 SOLO '
  'ULV SU3500, 2x2GB DDR3 ',
  100,
  Decimal('2'),
  923.219970703125,
  461.61),
 ('LCD0001',
  3,
  'MONITOR LCD 19 POLLICI LG W1943SS-PF',
  100,
  Decimal('6'),
  586.5600128173828,
  97.76),
 ('MBI0013',
  3,
  'SCHEDA MADRE ASROCK G41C-S, MICRO ATX, SOCKET 775, FSB1333-1066-800-533 '
  'MHZ, 2XDDR3  1333 E 2XDDR2 ',
  100,
  Decimal('11'),
  438.90001678466797,
  39.9),
 ('MBA0016',
  3,
  'SCHEDA MADRE AM3 GIGABYTE GA-M52LT-D3, CHIPSET NVIDIA NFORCE 520LE, 4XDDR3 '
  '1666+-1333-1066 MHZ, ',
  100,
  Decimal('6'),
  302.09999084472656,
  50.35),
 ('CTO0011',
  23,
  'TONER ORIGINALE HP CE505A NERO PER STAMPANTI P2035-P2055',
  100,
  Decimal('4'),
  285.0,
  71.25)]
1: ACER AS5810T-354G32MN
2: MONITOR LCD LG
3: SCHEDA MADRE ASROCK
4: SCHEDA MADRE AM3
5: TONER HP

9 QUALI SONO I METODI DI PAGAMENTO E SPEDIZIONE PRINCIPALI?
[(12, 'Consegna con corriere GLS', 9.9, 118.79999542236328, 'Contrassegno', 5.0, 60.0), (2, 'Consegna con corriere GLS', 9.9, 19.799999237060547, 'Pagamento con Carta di Credito', 0.0, 0.0), (3, 'Spedizione in posta', 31.0, 93.0, 'Contrassegno', 5.0, 15.0), (8, 'Spedizione in posta', 31.0, 248.0, 'Pagamento con Carta di Credito', 0.0, 0.0)]
Metodo spedizione: Consegna con corriere GLS = 14; Spedizione in posta = 11;
Metodo di pagamento: Contrassegno = 15; Pagamento con Carta di Credito = 10;

10a A QUALI CITTA SI SPEDISCE DI PIU'?
[('Cosenza', 'Cosenza', 2),
 ('Cosenza', 'Castrovillari', 1),
 ('Milano', 'Milano', 6),
 ('Milano', 'Cologno Monzese', 1),
 ('Milano', 'Assago', 1),
 ('Pistoia', 'Pistoia', 3),
 ('Pistoia', 'Massa e Cozzile', 1),
 ('Reggio Calabria', 'Gallico Superio-re', 1),
 ('Roma', 'Roma', 10),
 ('Roma', 'Frascati', 1),
 ('Roma', 'Nettuno', 1)]
Città: Roma, Milano

10b A QUALI PROVINCE SI SPEDISCE DI PIU'?
[('Roma', 12),
 ('Milano', 8),
 ('Pistoia', 4),
 ('Cosenza', 3),
 ('Reggio Calabria', 1)]
Province: Roma, Milano

Process finished with exit code 0

```
